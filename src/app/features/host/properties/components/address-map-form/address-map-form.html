<mat-card [formGroup]="formGroup" class="form-section-card">
  <mat-card-header>
    <mat-icon mat-card-avatar>location_on</mat-icon>
    <mat-card-title>Location Address</mat-card-title>
    <mat-card-subtitle>Where is your place located?</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Street Address</mat-label>
      <input matInput formControlName="street" placeholder="e.g., 123 Main St">
      @if (formGroup.get('street')?.hasError('required')) {
        <mat-error>Street address is required</mat-error>
      }
    </mat-form-field>

    <div class="form-grid">
      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <input matInput formControlName="city">
        @if (formGroup.get('city')?.hasError('required')) {
          <mat-error>City is required</mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>State / Province</mat-label>
        <input matInput formControlName="state">
        @if (formGroup.get('state')?.hasError('required')) {
          <mat-error>State/Province is required</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="form-grid">
      <mat-form-field appearance="outline">
        <mat-label>ZIP / Postal Code</mat-label>
        <input matInput formControlName="zipCode">
        @if (formGroup.get('zipCode')?.hasError('required')) {
          <mat-error>ZIP/Postal Code is required</mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <input matInput formControlName="country">
        @if (formGroup.get('country')?.hasError('required')) {
          <mat-error>Country is required</mat-error>
        }
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline" class="full-width map-search-field">
      <mat-label>Search Address on Map</mat-label>
      <input matInput [formControl]="addressSearch" placeholder="e.g., Eiffel Tower, Paris">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>

    <mat-button-toggle-group [formControl]="mapProvider" aria-label="Map Provider" class="map-provider-toggle">
      <mat-button-toggle value="Google">Google Maps</mat-button-toggle>
      <mat-button-toggle value="Nominatim">OpenStreetMap</mat-button-toggle>
    </mat-button-toggle-group>

    <div class="map-container">
      @if (mapProvider.value === 'Google') {
        <google-map
          height="300px"
          width="100%"
          [zoom]="zoom"
          [center]="center"
          [options]="{ disableDefaultUI: true }"
          (mapClick)="mapClicked($event)"
          >
          @if (markerPosition) {
            <map-marker
              [position]="markerPosition"
              [options]="markerOptions"
              (mapDragend)="markerDragged($event)"
            ></map-marker>
          }
        </google-map>
      } @else if (mapProvider.value === 'Nominatim') {
        <!-- Placeholder for OpenStreetMap (Leaflet) -->
        <div class="osm-placeholder">
          <p>OpenStreetMap will be displayed here (requires Leaflet library).</p>
          <p>Latitude: {{ formGroup.get('latitude')?.value }}</p>
          <p>Longitude: {{ formGroup.get('longitude')?.value }}</p>
        </div>
      }
    </div>

    <div class="form-grid map-coords">
      <mat-form-field appearance="outline">
        <mat-label>Latitude</mat-label>
        <input matInput type="number" formControlName="latitude" readonly>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Longitude</mat-label>
        <input matInput type="number" formControlName="longitude" readonly>
      </mat-form-field>
    </div>
  </mat-card-content>
</mat-card>

